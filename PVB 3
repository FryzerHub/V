-- Fryzer Hub for Plants vs Brainrot v2
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()
WindUI:SetNotificationLower(true)

WindUI:AddTheme({
    Name = "Blue Theme",
    Accent = Color3.fromRGB(37, 99, 235),
    Dialog = Color3.fromRGB(15, 23, 42),
    Outline = Color3.fromRGB(59, 130, 246),
    Text = Color3.fromRGB(248, 250, 252),
    Placeholder = Color3.fromRGB(100, 116, 139),
    Background = Color3.fromRGB(15, 23, 42),
    Button = Color3.fromRGB(30, 58, 138),
    Icon = Color3.fromRGB(147, 197, 253)
})

local Window = WindUI:CreateWindow({
    Title = "Fryzer Hub",
    Icon = "",
    Author = "Plants vs Brainrot",
    Folder = "AutoBuyHub",
    Size = UDim2.fromOffset(580, 460),
    MinSize = Vector2.new(560, 350),
    MaxSize = Vector2.new(850, 560),
    Transparent = true,
    Theme = "Blue Theme",
    Resizable = true,
    SideBarWidth = 200,
    BackgroundImageTransparency = 0.42,
    HideSearchBar = false,
    ScrollBarEnabled = true,
})

Window:Tag({
    Title = "v4.5",
    Color = Color3.fromHex("#30ff6a"),
    Radius = 8,
})

Window:Tag({
    Title = "PVB",
    Color = Color3.fromHex("#ff0000"),
    Radius = 10,
})

local InfoTab = Window:Tab({
    Title = "Info",
    Icon = "info",
    Locked = false,
})

InfoTab:Select()

local Sectiontest = InfoTab:Section({
    Title = "Player Information Dashboard",
    Icon = "user-check",
})

InfoTab:Paragraph({
    Title = "Player Information Dashboard",
    Desc = "Complete player details, game information, and community access",
    Color = "Blue",
    Image = "",
    ImageSize = 30,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
    Buttons = {}
})

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local Player = Players.LocalPlayer
local PlayerName = Player.DisplayName ~= "" and Player.DisplayName or Player.Name
local AccountAge = Player.AccountAge
local GameName = "Unknown Game"
pcall(function()
    GameName = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name
end)

InfoTab:Paragraph({
    Title = "üë§ " .. PlayerName,
    Desc = string.format(
        "üè∑Ô∏è Username: @%s\nüéÇ Account Age: %d days\nüÜî User ID: %d\nüéÆ Current Game: %s\nüë• Server: %d/%d players\nüìç Region: %s",
        Player.Name, AccountAge, Player.UserId, GameName,
        #Players:GetPlayers(), Players.MaxPlayers,
        game:GetService("LocalizationService").RobloxLocaleId
    ),
    Color = "Blue",
    Image = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. Player.UserId .. "&width=150&height=150&format=png",
    ImageSize = 52,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
    Buttons = {}
})

InfoTab:Divider()

local Section2 = InfoTab:Section({
    Title = "Join Our Discord Community",
    Icon = "users",
})

InfoTab:Paragraph({
    Title = "Join Our Discord Community",
    Desc = "Connect with other users, get support, and stay updated!",
    Color = "Blue",
    Image = "",
    ImageSize = 30,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
    Buttons = {}
})

InfoTab:Button({
    Title = "Copy Discord Link",
    Desc = "Copy invite link to clipboard",
    Locked = false,
    Callback = function()
        setclipboard("https://discord.gg/SYHphHCq9a")
        WindUI:Notify({
            Title = "Link Copied!",
            Content = "Discord link copied to clipboard",
            Duration = 3,
            Icon = "copy",
        })
    end
})

InfoTab:Space()

-- Configuration Variables for Seeds
local AUTO_BUY_ENABLED = false
local SELECTED_ITEMS = {}
local CLICK_DELAY = 0.1
local buyRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("BuyItem")

-- Configuration Variables for Gear
local AUTO_BUY_GEAR_ENABLED = false
local SELECTED_GEAR = {}
local GEAR_CLICK_DELAY = 0.1
local buyGearRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("BuyGear")

-- Available items (you can add more here)
local AVAILABLE_ITEMS = {
    "Cactus Seed",
    "Watermelon Seed",
    "Tomatrio Seed",
    "Sunflower Seed",
    "Strawberry Seed",
    "Shroombino Seed",
    "Pumpkin Seed",
    "Mr Carrot Seed",
    "Mango Seed",
    "King Limone Seed",
    "Grape Seed",
    "Eggplant Seed",
    "Dragon Fruit Seed",
    "Cocotank Seed",
    "Carnivorous Plant Seed",
}

-- Available gear items
local AVAILABLE_GEAR = {
    "Water Bucket",
    "Frost Grenade",
    "Frost Blower",
    "Carrot Launcher",
    "Banana Gun",
}

-- Function to buy seeds
local function clickButton(itemName)
    pcall(function()
        local args = {itemName, true}
        buyRemote:FireServer(unpack(args))
    end)
end

-- Function to buy gear
local function clickGearButton(gearName)
    pcall(function()
        local args = {gearName, true}
        buyGearRemote:FireServer(unpack(args))
    end)
end

-- Main auto-buy loop for seeds
local function startAutoBuy()
    spawn(function()
        while AUTO_BUY_ENABLED do
            if #SELECTED_ITEMS > 0 then
                for _, itemName in ipairs(SELECTED_ITEMS) do
                    clickButton(itemName)
                    wait(CLICK_DELAY / #SELECTED_ITEMS)
                end
            end
            wait(0.01)
        end
    end)
end

-- Main auto-buy loop for gear
local function startGearAutoBuy()
    spawn(function()
        while AUTO_BUY_GEAR_ENABLED do
            if #SELECTED_GEAR > 0 then
                for _, gearName in ipairs(SELECTED_GEAR) do
                    clickGearButton(gearName)
                    wait(GEAR_CLICK_DELAY / #SELECTED_GEAR)
                end
            end
            wait(0.01)
        end
    end)
end

-- Create Main Tab
local MainTab = Window:Tab({
    Title = "Auto",
    Icon = "repeat",
    Locked = false,
})

-- Section: Auto Buy Controls
local ControlSection = MainTab:Section({
    Title = "Auto Buy Controls",
    Icon = "shopping-cart",
})

local ControlSectionseeds = MainTab:Section({
    Title = "Seeds Auto Buyer",
    Icon = "",
})

-- Multi-Select Dropdown for Items
local ItemDropdown = MainTab:Dropdown({
    Title = "Select Items to Buy",
    Values = AVAILABLE_ITEMS,
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(selectedItems)
        SELECTED_ITEMS = selectedItems
        WindUI:Notify({
            Title = "Items Updated",
            Content = #selectedItems .. " item(s) selected for auto-buy",
            Duration = 2,
            Icon = "check",
        })
    end
})

-- Toggle for Auto Buy
local AutoBuyToggle = MainTab:Toggle({
    Title = "Enable Auto Buy",
    Desc = "Automatically purchase selected items",
    Default = false,
    Callback = function(value)
        AUTO_BUY_ENABLED = value
        
        if value then
            if #SELECTED_ITEMS == 0 then
                WindUI:Notify({
                    Title = "No Items Selected",
                    Content = "Please select items before enabling auto-buy",
                    Duration = 3,
                    Icon = "alert-triangle",
                })
                AutoBuyToggle:SetValue(false)
                return
            end
            
            WindUI:Notify({
                Title = "Auto Buy Started",
                Content = "Buying " .. #SELECTED_ITEMS .. " item(s) continuously",
                Duration = 3,
                Icon = "play",
            })
            startAutoBuy()
        else
            WindUI:Notify({
                Title = "Auto Buy Stopped",
                Content = "Auto-buy has been disabled",
                Duration = 2,
                Icon = "stop-circle",
            })
        end
    end
})

MainTab:Space()

local ControlSectionGear = MainTab:Section({
    Title = "Gear Auto Buyer",
    Icon = "",
})

-- Multi-Select Dropdown for Gear
local GearDropdown = MainTab:Dropdown({
    Title = "Select Gear to Buy",
    Values = AVAILABLE_GEAR,
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(selectedGear)
        SELECTED_GEAR = selectedGear
        WindUI:Notify({
            Title = "Gear Updated",
            Content = #selectedGear .. " gear item(s) selected for auto-buy",
            Duration = 2,
            Icon = "check",
        })
    end
})

-- Toggle for Gear Auto Buy
local GearAutoBuyToggle = MainTab:Toggle({
    Title = "Enable Gear Auto Buy",
    Desc = "Automatically purchase selected gear items",
    Default = false,
    Callback = function(value)
        AUTO_BUY_GEAR_ENABLED = value
        
        if value then
            if #SELECTED_GEAR == 0 then
                WindUI:Notify({
                    Title = "No Gear Selected",
                    Content = "Please select gear items before enabling auto-buy",
                    Duration = 3,
                    Icon = "alert-triangle",
                })
                GearAutoBuyToggle:SetValue(false)
                return
            end
            
            WindUI:Notify({
                Title = "Gear Auto Buy Started",
                Content = "Buying " .. #SELECTED_GEAR .. " gear item(s) continuously",
                Duration = 3,
                Icon = "play",
            })
            startGearAutoBuy()
        else
            WindUI:Notify({
                Title = "Gear Auto Buy Stopped",
                Content = "Gear auto-buy has been disabled",
                Duration = 2,
                Icon = "stop-circle",
            })
        end
    end
})

MainTab:Space()

local ControlSectionGear = MainTab:Section({
    Title = "Auto system",
    Icon = "",
})

-- Remote to fire repeatedly
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local EquipBestBrainrots = ReplicatedStorage.Remotes.EquipBestBrainrots -- RemoteEvent

-- Variables for toggle and interval control
local running = false
local interval = 50 -- Default interval in seconds (from slider)

-- Toggle to start/stop the repeating fire
local ToggleTimer = MainTab:Toggle({
    Title = "Auto Equip Best Brainrots",
    Desc = "",
    Default = false,
    Callback = function(state)
        running = state
        if state then
            -- Start the repeating loop in a new thread
            spawn(function()
                while running do
                    EquipBestBrainrots:FireServer()
                    print("Fired EquipBestBrainrots remote")
                    wait(interval) -- Wait for the set interval
                end
            end)
        end
        print("Auto Equip: " .. tostring(state))
    end
})

-- Slider to control the interval (in seconds)
local Slidertimer = MainTab:Slider({
    Title = "Repeat Interval",
    Step = 1,
    Value = {
        Min = 5,  -- Minimum 5 second to avoid spam
        Max = 300,
        Default = 50,
    },
    Callback = function(value)
        interval = value
        print("Interval set to: " .. value .. " seconds")
    end
})

local CombatTab = Window:Tab({
    Title = "Combat",
    Icon = "sword",
    Locked = false,
})

-- Kill Aura Settings and Functions
local Settings = {
    Enabled = false,
    AttackSpeed = 0.05,
    TweenSpeed = 0.3,
    Distance = 3,
    HeightOffset = 15,
    InfiniteMode = true,
    AttackAllMode = true,
    RarityFilterEnabled = true,
    TargetRarities = {},
    AttackAllRarities = false,
}

-- Get folders
local MissionBrainrotsFolder = Workspace:WaitForChild("ScriptedMap"):WaitForChild("MissionBrainrots")
local AttackRemote = ReplicatedStorage.Remotes.AttacksServer.WeaponAttack
local ChangeSettingRemote = ReplicatedStorage.Remotes.ChangeSetting

-- State variables
local currentTarget = nil
local isTweening = false
local lastAttackTime = 0
local totalKills = 0
local rarityKills = {}
local mainConnection = nil
local gravityConnection = nil
local searchConnection = nil
local showOthersDisabled = false

-- Available rarities
local RARITIES = { "Rare", "Epic", "Legendary", "Mythic", "Godly", "Secret", "Limited" }

-- Function to disable ShowOthers (runs continuously when enabled)
local function manageShowOthers()
    if Settings.Enabled and not showOthersDisabled then
        pcall(function()
            ChangeSettingRemote:FireServer({
                Value = false,
                Setting = "ShowOthers"
            })
        end)
        showOthersDisabled = true
        print("[VISIBILITY] ShowOthers disabled")
    end
end

-- Function to get brainrot position
local function getPosition(obj)
    if not obj or not obj.Parent then return nil end
   
    if obj:IsA("Model") then
        local part = obj.PrimaryPart or obj:FindFirstChild("HumanoidRootPart") or obj:FindFirstChildWhichIsA("BasePart")
        if part then return part.Position end
        return obj:GetPivot().Position
    elseif obj:IsA("BasePart") then
        return obj.Position
    elseif obj:IsA("Folder") then
        local part = obj:FindFirstChildWhichIsA("BasePart", true)
        if part then return part.Position end
    end
   
    return nil
end

-- Function to get brainrot rarity
local function getBrainrotRarity(brainrot)
    if not brainrot or not brainrot.Parent then return nil end
   
    local rarity = brainrot:GetAttribute("Rarity")
    if rarity then return rarity end
   
    local rarityValue = brainrot:FindFirstChild("Rarity")
    if rarityValue and rarityValue:IsA("ValueBase") then
        return rarityValue.Value
    end
   
    return nil
end

-- Function to check if brainrot matches rarity filter
local function matchesRarityFilter(brainrot)
    if not Settings.RarityFilterEnabled then return true end
    if Settings.AttackAllRarities then return true end
    if #Settings.TargetRarities == 0 then return true end
   
    local rarity = getBrainrotRarity(brainrot)
    if not rarity then return false end
   
    -- Check if rarity is in selected list
    for _, targetRarity in ipairs(Settings.TargetRarities) do
        if rarity:lower() == targetRarity:lower() then
            return true
        end
    end
   
    return false
end

-- Function to get brainrot ID
local function getBrainrotID(brainrot)
    if brainrot:IsA("Model") then
        local id = brainrot:GetAttribute("ID")
            or brainrot:GetAttribute("BrainrotID")
            or brainrot:GetAttribute("UniqueID")
            or brainrot:GetAttribute("GUID")
       
        if id then return id end
       
        local idValue = brainrot:FindFirstChild("ID")
            or brainrot:FindFirstChild("BrainrotID")
            or brainrot:FindFirstChild("UniqueID")
       
        if idValue and idValue:IsA("ValueBase") then
            return idValue.Value
        end
    end
   
    return brainrot
end

-- Function to find nearest brainrot
local function findNearest()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return nil
    end
   
    local playerPos = LocalPlayer.Character.HumanoidRootPart.Position
    local nearest = nil
    local nearestDist = math.huge
   
    for _, brainrot in pairs(MissionBrainrotsFolder:GetChildren()) do
        if matchesRarityFilter(brainrot) then
            local pos = getPosition(brainrot)
            if pos then
                local dist = (pos - playerPos).Magnitude
                if dist < nearestDist then
                    nearest = brainrot
                    nearestDist = dist
                end
            end
        end
    end
   
    return nearest
end

-- Function to tween to target
local function tweenToTarget(targetPos)
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
   
    local hrp = LocalPlayer.Character.HumanoidRootPart
    local direction = (targetPos - hrp.Position).Unit
    local closePos = targetPos - (direction * Settings.Distance)
    local airPos = closePos + Vector3.new(0, Settings.HeightOffset, 0)
   
    local tweenInfo = TweenInfo.new(
        Settings.TweenSpeed,
        Enum.EasingStyle.Linear,
        Enum.EasingDirection.InOut
    )
   
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(airPos, targetPos)})
   
    isTweening = true
    tween:Play()
   
    tween.Completed:Connect(function()
        isTweening = false
    end)
end

-- Function to attack all brainrots
local function attackAll()
    local missionBrainrots = {}
   
    for _, brainrot in pairs(MissionBrainrotsFolder:GetChildren()) do
        if matchesRarityFilter(brainrot) then
            local id = getBrainrotID(brainrot)
            if id then
                table.insert(missionBrainrots, id)
            end
        end
    end
   
    if #missionBrainrots > 0 then
        local args = {
            {
                NormalBrainrots = {},
                MissionBrainrots = missionBrainrots
            }
        }
       
        pcall(function()
            AttackRemote:FireServer(unpack(args))
        end)
    end
end

-- Function to attack single target
local function attack(brainrotID)
    if not brainrotID then return end
   
    local args = {
        {
            NormalBrainrots = {},
            MissionBrainrots = { brainrotID }
        }
    }
   
    pcall(function()
        AttackRemote:FireServer(unpack(args))
    end)
end

-- Function to start the kill aura
local function startKillAura()
    if mainConnection then return end
   
    print("[KILL AURA] Starting...")
    manageShowOthers()
   
    -- Main loop
    mainConnection = RunService.Heartbeat:Connect(function()
        if not Settings.Enabled then return end
       
        -- Check if target is still valid
        if currentTarget and not currentTarget.Parent then
            local rarity = getBrainrotRarity(currentTarget) or "Unknown"
            rarityKills[rarity] = (rarityKills[rarity] or 0) + 1
            totalKills = totalKills + 1
            currentTarget = nil
        end
       
        -- Find new target
        if not currentTarget or not currentTarget.Parent then
            currentTarget = findNearest()
            if currentTarget then
                local pos = getPosition(currentTarget)
                if pos then
                    tweenToTarget(pos)
                end
            else
                task.wait(0.1)
                return
            end
        end
       
        -- Keep player floating
        if currentTarget and not isTweening then
            local targetPos = getPosition(currentTarget)
            if targetPos and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local hrp = LocalPlayer.Character.HumanoidRootPart
                local currentDist = (hrp.Position - targetPos).Magnitude
               
                if currentDist > 10 then
                    tweenToTarget(targetPos)
                end
            end
        end
       
        -- Attack
        local currentTime = tick()
        if currentTime - lastAttackTime >= Settings.AttackSpeed then
            if Settings.AttackAllMode then
                attackAll()
            elseif currentTarget then
                local brainrotID = getBrainrotID(currentTarget)
                attack(brainrotID)
            end
            lastAttackTime = currentTime
        end
    end)
   
    -- Keep player in air
    gravityConnection = RunService.RenderStepped:Connect(function()
        if Settings.Enabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = LocalPlayer.Character.HumanoidRootPart
            hrp.Velocity = Vector3.new(hrp.Velocity.X, 0, hrp.Velocity.Z)
        end
    end)
   
    -- Auto-search loop
    searchConnection = task.spawn(function()
        while Settings.Enabled and Settings.InfiniteMode do
            task.wait(2)
            if Settings.Enabled and not currentTarget then
                currentTarget = findNearest()
            end
        end
    end)
   
    print("[KILL AURA] Started successfully!")
end

-- Function to stop the kill aura
local function stopKillAura()
    print("[KILL AURA] Stopping...")
   
    if mainConnection then
        mainConnection:Disconnect()
        mainConnection = nil
    end
   
    if gravityConnection then
        gravityConnection:Disconnect()
        gravityConnection = nil
    end
   
    if searchConnection then
        task.cancel(searchConnection)
        searchConnection = nil
    end
   
    currentTarget = nil
    isTweening = false
    showOthersDisabled = false
   
    print("[KILL AURA] Stopped!")
end

-- Combat Tab UI Elements
local MainSection = CombatTab:Section({
    Title = "Main Controls",
    Icon = "power",
})

local StatsParagraph = CombatTab:Paragraph({
    Title = "Before Enabling Kill Aura \n *Make sure to hold a bat",
    Desc = "",
    Color = "Blue",
    Image = "",
    ImageSize = 30,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
    Buttons = {}
})

local MainToggle = CombatTab:Toggle({
    Title = "Enable Auto Attack",
    Desc = "",
    Default = false,
    Callback = function(state)
        Settings.Enabled = state
       
        if state then
            startKillAura()
            WindUI:Notify({
                Title = "Kill Aura Enabled",
                Content = "Super fast movement and spam attack activated",
                Duration = 3,
                Icon = "play",
            })
        else
            stopKillAura()
            WindUI:Notify({
                Title = "Kill Aura Disabled",
                Content = "Kill aura stopped",
                Duration = 2,
                Icon = "stop-circle",
            })
        end
       
        print("[TOGGLE] Kill Aura:", state and "ON" or "OFF")
    end
})

CombatTab:Space()

local SettingsSection = CombatTab:Section({
    Title = "Settings",
    Icon = "settings",
})

local RarityDropdown = CombatTab:Dropdown({
    Title = "Target Rarities",
    Values = RARITIES,
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(selectedRarities)
        Settings.TargetRarities = selectedRarities
       
        if #selectedRarities == 0 then
            Settings.AttackAllRarities = true
            print("[RARITY] No rarities selected - Attacking ALL")
            WindUI:Notify({
                Title = "Rarity Filter",
                Content = "No rarities selected - Attacking all",
                Duration = 2,
                Icon = "info",
            })
        else
            Settings.AttackAllRarities = false
            print("[RARITY] Selected:", table.concat(selectedRarities, ", "))
            WindUI:Notify({
                Title = "Rarity Filter",
                Content = table.concat(selectedRarities, ", ") .. " selected",
                Duration = 2,
                Icon = "check",
            })
        end
    end
})

local HeightSlider = CombatTab:Slider({
    Title = "Height Offset",
    Desc = "How high to float above targets",
    Step = 1,
    Value = {
        Min = 5,
        Max = 50,
        Default = 15,
    },
    Callback = function(value)
        Settings.HeightOffset = value
        print("[HEIGHT] Set to:", value, "studs")
        WindUI:Notify({
            Title = "Height Offset",
            Content = "Set to " .. value .. " studs",
            Duration = 2,
            Icon = "check",
        })
    end
})

CombatTab:Space()

local StatsSection = CombatTab:Section({
    Title = "Statistics",
    Icon = "bar-chart-2",
})

local StatsParagraph = CombatTab:Paragraph({
    Title = "Kill Statistics",
    Desc = "Total Kills: 0\n\nKills by Rarity:\n‚Ä¢ Unknown: 0",
    Color = "Blue",
    Image = "",
    ImageSize = 30,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
    Buttons = {}
})

local function updateStats()
    local statsText = string.format("Total Kills: %d\n\nKills by Rarity:", totalKills)
   
    for rarity, count in pairs(rarityKills) do
        statsText = statsText .. string.format("\n‚Ä¢ %s: %d", rarity, count)
    end
   
    if StatsParagraph and StatsParagraph.SetDesc then
        StatsParagraph:SetDesc(statsText)
    else
        -- Fallback: recreate or assume library supports
        print(statsText)
    end
end

-- Update stats every 2 seconds
task.spawn(function()
    while true do
        task.wait(2)
        updateStats()
    end
end)

local ResetButton = CombatTab:Button({
    Title = "Reset Statistics",
    Desc = "Clear all kill counts",
    Locked = false,
    Callback = function()
        totalKills = 0
        rarityKills = {}
        updateStats()
        print("[STATS] Reset!")
        WindUI:Notify({
            Title = "Stats Reset",
            Content = "All kill counts cleared",
            Duration = 2,
            Icon = "refresh-cw",
        })
    end
})

CombatTab:Space()

local SpawnTab = Window:Tab({
    Title = "Spawner",
    Icon = "box",
    Locked = false,
})

--// Tool Copier - Copy tools from ReplicatedStorage to Backpack

local player = game:GetService("Players").LocalPlayer
local backpack = player.Backpack
local replicatedStorage = game:GetService("ReplicatedStorage")

-- Asset paths to copy from
local assetPaths = {
	{name = "Seeds", path = replicatedStorage.Assets.Seeds},
	{name = "Eggs", path = replicatedStorage.Assets.Eggs},
	{name = "Crates", path = replicatedStorage.Assets.Crates},
	{name = "Bats", path = replicatedStorage.Assets.Bats}
}

-- Function to get all tool names from a path
local function getToolNames(path)
	local toolNames = {}
	if not path then return toolNames end
	
	for _, item in pairs(path:GetChildren()) do
		if item:IsA("Tool") then
			table.insert(toolNames, item.Name)
		end
	end
	return toolNames
end

-- Function to copy tool to backpack
local function copyToolToBackpack(tool)
	if tool:IsA("Tool") then
		local clone = tool:Clone()
		clone.Parent = backpack
		return true
	end
	return false
end

-- Function to copy multiple tools by name
local function copyToolsByNames(path, toolNames)
	local copied = 0
	local failed = 0
	
	for _, toolName in pairs(toolNames) do
		local tool = path:FindFirstChild(toolName)
		if tool and copyToolToBackpack(tool) then
			copied = copied + 1
		else
			failed = failed + 1
		end
		wait(0.05)
	end
	
	return copied, failed
end

-- Status label to display feedback
local statusText = "Ready to copy tools"

-- Create sections and components for each category
for _, categoryData in ipairs(assetPaths) do
	local Section = SpawnTab:Section({
		Title = categoryData.name,
		Icon = "box",
	})
	
	-- Get all tool names for this category
	local toolNames = getToolNames(categoryData.path)
	
	-- Create dropdown to select tools
	local Dropdown = Section:Dropdown({
		Title = categoryData.name .. " Items",
		Desc = "Select items to copy from " .. categoryData.name,
		Values = toolNames,
		Value = {},
		Multi = true,
		AllowNone = true,
		Callback = function(options)
			-- Store selected tools for later use
			print(categoryData.name .. " selected: " .. game:GetService("HttpService"):JSONEncode(options))
		end
	})
	
	-- Create Copy Selected button
	local CopySelectedBtn = Section:Button({
		Title = "Copy Selected " .. categoryData.name,
		Desc = "Copy only the selected items from " .. categoryData.name,
		Locked = false,
		Callback = function()
			local selectedTools = Dropdown.Value or {}
			
			if #selectedTools == 0 then
				print("No tools selected from " .. categoryData.name)
				return
			end
			
			statusText = "Copying " .. categoryData.name .. " items..."
			print(statusText)
			
			local copied, failed = copyToolsByNames(categoryData.path, selectedTools)
			
			statusText = "‚úÖ Copied " .. copied .. " tools from " .. categoryData.name
			if failed > 0 then
				statusText = statusText .. " (" .. failed .. " failed)"
			end
			print(statusText)
		end
	})
	
	-- Create Copy All button for this category
	local CopyAllBtn = Section:Button({
		Title = "Copy All " .. categoryData.name,
		Desc = "Copy all items from " .. categoryData.name,
		Locked = false,
		Callback = function()
			statusText = "Copying all " .. categoryData.name .. "..."
			print(statusText)
			
			local copied = 0
			local failed = 0
			
			for _, item in pairs(categoryData.path:GetChildren()) do
				if copyToolToBackpack(item) then
					copied = copied + 1
				else
					failed = failed + 1
				end
				wait(0.05)
			end
			
			statusText = "‚úÖ Copied " .. copied .. " tools from " .. categoryData.name
			if failed > 0 then
				statusText = statusText .. " (" .. failed .. " failed)"
			end
			print(statusText)
		end
	})
end

-- Create a Master Controls section
local MasterSection = SpawnTab:Section({
	Title = "Master Controls",
	Icon = "settings",
})

-- Copy Everything button
local CopyEverythingBtn = MasterSection:Button({
	Title = "Copy Everything",
	Desc = "Copy all tools from all categories",
	Locked = false,
	Callback = function()
		statusText = "Copying all categories..."
		print(statusText)
		
		local totalCopied = 0
		local totalFailed = 0
		
		for _, categoryData in ipairs(assetPaths) do
			for _, item in pairs(categoryData.path:GetChildren()) do
				if copyToolToBackpack(item) then
					totalCopied = totalCopied + 1
				else
					totalFailed = totalFailed + 1
				end
				wait(0.05)
			end
		end
		
		statusText = "‚úÖ Copied " .. totalCopied .. " total tools!"
		if totalFailed > 0 then
			statusText = statusText .. " (" .. totalFailed .. " failed)"
		end
		print(statusText)
	end
})

print("‚úÖ Tool Copier loaded!")
print("üì¶ Categories: Seeds, Eggs, Crates, Bats")
print("üîß Select items from dropdowns and click 'Copy Selected' or use 'Copy All' for each category")

local TpTab = Window:Tab({
    Title = "Teleport",
    Icon = "map-pin",
    Locked = false,
})

local ButtonTp1 = TpTab:Button({
    Title = "Teleport to Plot 1",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["1"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonTp2 = TpTab:Button({
    Title = "Teleport to Plot 2",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["2"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonTp3 = TpTab:Button({
    Title = "Teleport to Plot 3",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["3"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonTp4 = TpTab:Button({
    Title = "Teleport to Plot 4",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["4"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonTp5 = TpTab:Button({
    Title = "Teleport to Plot 5",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["5"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonTp6 = TpTab:Button({
    Title = "Teleport to Plot 6",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local targetPart = workspace.Plots["6"].Origin
            if targetPart and targetPart:IsA("BasePart") then
                character.HumanoidRootPart.CFrame = targetPart.CFrame
                print("Teleported to Plot 1 Origin")
            else
                print("Target part not found!")
            end
        else
            print("Character not loaded!")
        end
    end
})

local ButtonEvnt = TpTab:Button({
    Title = "Teleport to Event area",
    Desc = "",
    Locked = false,
    Callback = function()
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        
        -- Teleport to the specified Vector3 position
        humanoidRootPart.CFrame = CFrame.new(Vector3.new(-173.81, 17.61, 978.32))
        
        print("Teleported")
    end
})


--// Seed Stock Notifier - UI Version

local NotifierTab = Window:Tab({
    Title = "Seed Notifier",
    Icon = "bell",
    Locked = false,
})

-- All available seeds
local allSeeds = {
	"Cactus Seed",
	"Watermelon Seed",
	"Tomatrio Seed",
	"Sunflower Seed",
	"Strawberry Seed",
	"Shroombino Seed",
	"Pumpkin Seed",
	"Mr Carrot Seed",
	"Mango Seed",
	"King Limone Seed",
	"Grape Seed",
	"Eggplant Seed",
	"Dragon Fruit Seed",
	"Cocotank Seed",
	"Carnivorous Plant Seed",
	"Starfruit Seed"
}

-- Color options for embed
local colorOptions = {
	"Red",
	"Blue",
	"Green",
	"Yellow",
	"Purple",
	"Orange",
	"Pink",
	"Cyan"
}

local colorMap = {
	["Red"] = 16711680,
	["Blue"] = 255,
	["Green"] = 65280,
	["Yellow"] = 16776960,
	["Purple"] = 9109504,
	["Orange"] = 16744448,
	["Pink"] = 16711935,
	["Cyan"] = 65535
}

-- Variables
local webhook = ""
local notifierTitle = "üå± Seed Stock Alert"
local selectedSeeds = {}
local selectedColor = "Blue"
local running = false
local lastSentTime = "Never"
local nextRestockTime = "--:--"
local hasSent458 = false

-- Function to get seed stock data
local function getSeedStockData(seeds)
	local player = game:GetService("Players").LocalPlayer
	local basePath = player.PlayerGui.Main.Seeds.Frame.ScrollingFrame
	
	local stockData = {}
	for _, seedName in ipairs(seeds) do
		local success, stock = pcall(function()
			return basePath[seedName].Stock.Text
		end)
		
		if success then
			table.insert(stockData, "*" .. seedName .. ":* " .. stock)
		else
			table.insert(stockData, "*" .. seedName .. ":* ‚ùå Not Found")
		end
	end
	
	return table.concat(stockData, "\n")
end

-- Function to send notification
local function sendNotification(restockTime)
	if webhook == "" then
		print("‚ùå Webhook URL not set!")
		return
	end
	
	local sedsToSend = #selectedSeeds > 0 and selectedSeeds or allSeeds
	local stockInfo = getSeedStockData(sedsToSend)
	local timestamp = os.date("%I:%M:%S %p")
	local embedColor = colorMap[selectedColor] or 255
	
	local data = {
		["embeds"] = {{
			["title"] = notifierTitle,
			["description"] = stockInfo,
			["color"] = embedColor,
			["footer"] = {
				["text"] = "Alert sent at " .. timestamp .. " | By Fryzer"
			}
		}}
	}

	local success, err = pcall(function()
		request({
			Url = webhook,
			Method = "POST",
			Headers = {["Content-Type"] = "application/json"},
			Body = game:GetService("HttpService"):JSONEncode(data)
		})
	end)

	if success then
		lastSentTime = timestamp .. " (at 04:57)"
		hasSent458 = true
		print("‚úÖ Notification sent!")
	else
		warn("‚ùå Notifier Error:", err)
	end
end

-- Function to check restock timer
local function checkRestockTimer()
	local player = game:GetService("Players").LocalPlayer
	local success, restockText = pcall(function()
		return player.PlayerGui.Main.Seeds.Restock.Text
	end)
	
	if success and restockText then
		nextRestockTime = restockText:match("New seeds in (.+)") or restockText
		
		if restockText:match("04:57") then
			if not hasSent458 then
				sendNotification(restockText)
			end
		else
			if hasSent458 then
				hasSent458 = false
			end
		end
	else
		nextRestockTime = "‚ùå Not Found"
	end
end

-- Webhook Input
pcall(function()
	local WebhookInput = NotifierTab:Input({
		Title = "Webhook URL",
		Desc = "Enter your Discord webhook URL",
		Placeholder = "https://discord.com/api/webhooks/...",
		Callback = function(input)
			webhook = input
			print("‚úÖ Webhook set!")
		end
	})
end)

-- Title Input
pcall(function()
	local TitleInput = NotifierTab:Input({
		Title = "Notification Title",
		Placeholder = "Seed Stock Alert",
		Callback = function(input)
			if input and input ~= "" then
				notifierTitle = input
			else
				notifierTitle = "Seed Stock Alert"
			end
			print("‚úÖ Title updated!")
		end
	})
end)

-- Color Dropdown
local ColorDropdown = NotifierTab:Dropdown({
	Title = "Embed Color",
	Desc = "Choose embed color for Discord message",
	Values = colorOptions,
	Value = "Blue",
	Callback = function(option)
		selectedColor = option
		print("‚úÖ Color set to: " .. option)
	end
})

-- Seeds Dropdown
local SeedsDropdown = NotifierTab:Dropdown({
	Title = "Seeds to Monitor",
	Desc = "Select which seeds to include in notifications",
	Values = allSeeds,
	Value = {},
	Multi = true,
	AllowNone = true,
	Callback = function(options)
		selectedSeeds = options
		print("‚úÖ Seeds selected!")
	end
})

-- Main Toggle
local MainToggle = NotifierTab:Toggle({
	Title = "Enable Notifier",
	Desc = "Start/Stop monitoring restock timer",
	Icon = "power",
	Default = false,
	Callback = function(state)
		running = state
		if running then
			hasSent458 = false
			print("‚úÖ Seed notifier started!")
		else
			print("‚ùå Seed notifier stopped!")
		end
	end
})

-- Main monitoring loop
spawn(function()
	while true do
		wait(0.5)
		
		if running then
			checkRestockTimer()
		else
			wait(1)
		end
	end
end)

print("‚úÖ Seed Stock Notifier UI loaded!")
print("üìã Configure webhook, title, and seeds")
print("üå± Select seeds and enable to start monitoring")

-- All available gears
local allGears = {
	"Water Bucket",
	"Frost Grenade",
	"Frost Blower",
	"Carrot Launcher",
	"Banana Gun"
}

-- Divider for Gear Section
NotifierTab:Divider()

-- Variables for Gears
local gearWebhook = ""
local gearTitle = "‚öôÔ∏è Gear Stock Alert"
local selectedGears = {}
local gearSelectedColor = "Blue"
local gearRunning = false
local gearLastSentTime = "Never"
local gearNextRestockTime = "--:--"
local gearHasSent458 = false

-- Function to get gear stock data
local function getGearStockData(gears)
	local player = game:GetService("Players").LocalPlayer
	local basePath = player.PlayerGui.Main.Gears.Frame.ScrollingFrame
	
	local stockData = {}
	for _, gearName in ipairs(gears) do
		local success, stock = pcall(function()
			return basePath[gearName].Stock.Text
		end)
		
		if success then
			table.insert(stockData, "*" .. gearName .. ":* " .. stock)
		else
			table.insert(stockData, "*" .. gearName .. ":* ‚ùå Not Found")
		end
	end
	
	return table.concat(stockData, "\n")
end

-- Function to send gear notification
local function sendGearNotification(restockTime)
	if gearWebhook == "" then
		print("‚ùå Gear Webhook URL not set!")
		return
	end
	
	local gearsToSend = #selectedGears > 0 and selectedGears or allGears
	local stockInfo = getGearStockData(gearsToSend)
	local timestamp = os.date("%I:%M:%S %p")
	local embedColor = colorMap[gearSelectedColor] or 255
	
	local data = {
		["embeds"] = {{
			["title"] = gearTitle,
			["description"] = stockInfo,
			["color"] = embedColor,
			["footer"] = {
				["text"] = "Alert sent at " .. timestamp .. " | By Fryzer"
			}
		}}
	}

	local success, err = pcall(function()
		request({
			Url = gearWebhook,
			Method = "POST",
			Headers = {["Content-Type"] = "application/json"},
			Body = game:GetService("HttpService"):JSONEncode(data)
		})
	end)

	if success then
		gearLastSentTime = timestamp .. " (at 04:57)"
		gearHasSent458 = true
		print("‚úÖ Gear notification sent!")
	else
		warn("‚ùå Gear Notifier Error:", err)
	end
end

-- Function to check gear restock timer
local function checkGearRestockTimer()
	local player = game:GetService("Players").LocalPlayer
	local success, restockText = pcall(function()
		return player.PlayerGui.Main.Gears.Restock.Text
	end)
	
	if success and restockText then
		gearNextRestockTime = restockText:match("New gears in (.+)") or restockText
		
		if restockText:match("04:57") then
			if not gearHasSent458 then
				sendGearNotification(restockText)
			end
		else
			if gearHasSent458 then
				gearHasSent458 = false
			end
		end
	else
		gearNextRestockTime = "‚ùå Not Found"
	end
end

-- Gear Webhook Input
pcall(function()
	local GearWebhookInput = NotifierTab:Input({
		Title = "Gear Webhook URL",
		Desc = "Enter your Discord webhook URL for gears",
		Placeholder = "https://discord.com/api/webhooks/...",
		Callback = function(input)
			gearWebhook = input
			print("‚úÖ Gear Webhook set!")
		end
	})
end)

-- Gear Title Input
pcall(function()
	local GearTitleInput = NotifierTab:Input({
		Title = "Gear Notification Title",
		Placeholder = "Gear Stock Alert",
		Callback = function(input)
			if input and input ~= "" then
				gearTitle = input
			else
				gearTitle = "Gear Stock Alert"
			end
			print("‚úÖ Gear title updated!")
		end
	})
end)

-- Gear Color Dropdown
local GearColorDropdown = NotifierTab:Dropdown({
	Title = "Gear Embed Color",
	Desc = "Choose embed color for gear Discord message",
	Values = colorOptions,
	Value = "Blue",
	Callback = function(option)
		gearSelectedColor = option
		print("‚úÖ Gear color set to: " .. option)
	end
})

-- Gears Dropdown
local GearsDropdown = NotifierTab:Dropdown({
	Title = "Gears to Monitor",
	Desc = "Select which gears to include in notifications",
	Values = allGears,
	Value = {},
	Multi = true,
	AllowNone = true,
	Callback = function(options)
		selectedGears = options
		print("‚úÖ Gears selected!")
	end
})

-- Gear Main Toggle
local GearMainToggle = NotifierTab:Toggle({
	Title = "Enable Gear Notifier",
	Desc = "Start/Stop monitoring gear restock timer",
	Icon = "power",
	Default = false,
	Callback = function(state)
		gearRunning = state
		if state then
			gearHasSent458 = false
			print("‚úÖ Gear notifier started!")
		else
			print("‚ùå Gear notifier stopped!")
		end
	end
})

-- Gear monitoring loop
spawn(function()
	while true do
		wait(0.5)
		
		if gearRunning then
			checkGearRestockTimer()
		else
			wait(1)
		end
	end
end)

print("‚úÖ Gear Stock Notifier UI loaded!")
print("üìã Configure gear webhook, title, and gears")
print("‚öôÔ∏è Select gears and enable to start monitoring")
--

local MiscTab = Window:Tab({
    Title = "Misc",
    Icon = "folder",
    Locked = false,
})

local ToggleAntiAFK = MiscTab:Toggle({
    Title = "Anti AFK",
    Desc = "Prevents automatic idle kick",
    Icon = "shield-check",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        if state then
            local player = game.Players.LocalPlayer

            -- Disconnect existing idle connections if any
            if getgenv().AntiAFKConnection then
                getgenv().AntiAFKConnection:Disconnect()
            end

            -- Connect to Idled event
            getgenv().AntiAFKConnection = player.Idled:Connect(function()
                -- simulate click or jump to prevent kick
                game:GetService("VirtualUser"):CaptureController()
                game:GetService("VirtualUser"):ClickButton2(Vector2.new())
                print("‚è± Anti-AFK triggered!")
            end)

            print("‚úÖ Anti-AFK enabled")
        else
            -- Disconnect Anti-AFK
            if getgenv().AntiAFKConnection then
                getgenv().AntiAFKConnection:Disconnect()
                getgenv().AntiAFKConnection = nil
            end
            print("‚õî Anti-AFK disabled")
        end
    end
})

local Buttonpowersave = MiscTab:Button({
    Title = "Power Save Mode",
    Desc = "Open Power Save Script",
    Locked = false,
    Callback = function()
        print("Opening Power Save Script...")
        loadstring(game:HttpGet("https://raw.githubusercontent.com/FryzerHub/SubScripts/refs/heads/main/screen%20saver"))()
    end
})

-- ==================== TAB 6: SETTINGS ====================
local Tab6 = Window:Tab({
    Title = "Settings",
    Icon = "settings",
    Locked = false,
})

local SettingsSection1 = Tab6:Section({
    Title = "Window Settings",
    Icon = "layout",
})

Tab6:Space()

-- Transparency Toggle
local TransparencyToggle = Tab6:Toggle({
    Title = "Window Transparency",
    Desc = "Toggle window transparency on/off",
    Icon = "eye",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        Window:ToggleTransparency(state)
        print("Transparency: " .. tostring(state))
    end
})

Tab6:Divider()

local SettingsSection2 = Tab6:Section({
    Title = "Keybind Settings",
    Icon = "keyboard",
})

-- Input field for keybind
local KeybindInput = Tab6:Input({
    Title = "Toggle UI Keybind",
    Desc = "Type ONE letter or key (e.g., Q or RightControl)",
    Value = "RightControl",
    InputIcon = "keyboard",
    Type = "Input",
    Placeholder = "Enter key...",
    Callback = function(input)
        -- Trim whitespace
        input = input:gsub("^%s*(.-)%s*$", "%1")
        
        local keyCode
        
        -- Check if it's a single letter (case insensitive)
        if #input == 1 then
            local upperInput = input:upper()
            keyCode = Enum.KeyCode[upperInput]
        else
            -- Try as a full KeyCode name
            local success, result = pcall(function()
                return Enum.KeyCode[input]
            end)
            if success then
                keyCode = result
            end
        end
        
        if keyCode then
            Window:SetToggleKey(keyCode)
            print("Keybind set to: " .. input)
            WindUI:Notify({
                Title = "Keybind Updated",
                Content = "Press '" .. input .. "' to toggle UI",
                Duration = 3,
                Icon = "check",
            })
        else
            print("Invalid key: " .. input)
            WindUI:Notify({
                Title = "Invalid Key",
                Content = "Enter a single letter (Q) or key name (RightControl)",
                Duration = 4,
                Icon = "x",
            })
        end
    end
})

-- Set default toggle key
Window:SetToggleKey(Enum.KeyCode.RightControl)

Tab6:Space()

-- ==================== WINDOW LEVEL COMPONENTS ====================
Window:Space()

-- Final Notification
WindUI:Notify({
    Title = "All Components Loaded",
    Content = "Every component is now visible!",
    Duration = 5,
    Icon = "check-circle",
})

WindUI:Notify({
    Title = "Fryzer Hub Loaded",
    Content = "Script is ready to use!",
    Duration = 2.5,
    Icon = "check-circle",
})

Window:OnDestroy(function()
    stopKillAura()
    print("Window destroyed")
end)

-- Cleanup on script stop
game:GetService("Players").LocalPlayer.OnTeleport:Connect(function()
    stopKillAura()
end)
